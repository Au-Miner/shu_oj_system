(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Login"],{"013f":function(e,r,s){"use strict";s.r(r);var t=function(){var e=this,r=e.$createElement,s=e._self._c||r;return s("div",{staticClass:"form_box"},[s("div",{directives:[{name:"show",rawName:"v-show",value:"login"===e.showWhichForm,expression:"showWhichForm === 'login'"}]},[s("div",{staticClass:"top_title"},[e._v("登陆")]),s("el-form",{ref:"loginFormRef",attrs:{model:e.loginForm,rules:e.loginFormRules}},[s("el-form-item",{attrs:{prop:"username_or_email"}},[s("el-input",{attrs:{placeholder:"请输入用户名或邮箱","prefix-icon":"el-icon-user"},model:{value:e.loginForm.username_or_email,callback:function(r){e.$set(e.loginForm,"username_or_email",r)},expression:"loginForm.username_or_email"}})],1),s("el-form-item",{attrs:{prop:"password"}},[s("el-input",{attrs:{type:"password",placeholder:"请输入密码","prefix-icon":"el-icon-lock","show-password":""},model:{value:e.loginForm.password,callback:function(r){e.$set(e.loginForm,"password",r)},expression:"loginForm.password"}})],1)],1),s("div",[s("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.beforeSubmitLoginForm()}}},[e._v("登录")]),s("el-button",{on:{click:function(r){return e.jumpToHome()}}},[e._v("取消")])],1),s("div",{staticClass:"margin_top_10"},[s("el-link",{attrs:{underline:!1,type:"primary"},on:{click:function(r){return e.switchForm("reset_password")}}},[e._v("忘记密码")]),s("span",{staticStyle:{margin:"0px 10px",color:"#275ac0"}},[e._v("|")]),s("el-link",{attrs:{underline:!1,type:"primary"},on:{click:function(r){return e.switchForm("register")}}},[e._v("新用户注册")])],1)],1),s("div",{directives:[{name:"show",rawName:"v-show",value:"register"===e.showWhichForm,expression:"showWhichForm === 'register'"}]},[s("div",{staticClass:"top_title"},[e._v("注册")]),s("el-form",{ref:"registerFormRef",attrs:{model:e.registerForm,rules:e.registerFormRules}},[s("el-form-item",{attrs:{prop:"username"}},[s("el-input",{attrs:{placeholder:"请输入用户名","prefix-icon":"el-icon-user"},model:{value:e.registerForm.username,callback:function(r){e.$set(e.registerForm,"username",r)},expression:"registerForm.username"}})],1),s("el-form-item",{attrs:{prop:"password"}},[s("el-input",{attrs:{type:"password",placeholder:"请输入密码","prefix-icon":"el-icon-lock","show-password":""},model:{value:e.registerForm.password,callback:function(r){e.$set(e.registerForm,"password",r)},expression:"registerForm.password"}})],1),s("el-form-item",{attrs:{prop:"password_confirm"}},[s("el-input",{attrs:{type:"password",placeholder:"请再次输入密码","prefix-icon":"el-icon-lock","show-password":""},model:{value:e.registerForm.password_confirm,callback:function(r){e.$set(e.registerForm,"password_confirm",r)},expression:"registerForm.password_confirm"}})],1),s("el-form-item",{attrs:{prop:"email"}},[s("el-input",{attrs:{placeholder:"请输入邮箱","prefix-icon":"el-icon-message"},model:{value:e.registerForm.email,callback:function(r){e.$set(e.registerForm,"email",r)},expression:"registerForm.email"}})],1)],1),s("div",[s("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.beforeSubmitRegisterForm()}}},[e._v("注册")]),s("el-button",{on:{click:function(r){return e.jumpToHome()}}},[e._v("取消")])],1),s("div",{staticClass:"margin_top_10"},[s("span",{staticStyle:{"font-size":"14px"}},[e._v("已有账号？")]),s("el-link",{attrs:{underline:!1,type:"primary"},on:{click:function(r){return e.switchForm("login")}}},[e._v("立即登录")])],1)],1),s("div",{directives:[{name:"show",rawName:"v-show",value:"reset_password"===e.showWhichForm,expression:"showWhichForm === 'reset_password'"}]},[s("div",{staticClass:"top_title"},[e._v("重置密码")]),s("el-form",{ref:"resetPasswordFormRef",attrs:{model:e.resetPasswordForm,rules:e.resetPasswordFormRules}},[s("el-form-item",{attrs:{prop:"email"}},[s("el-input",{attrs:{placeholder:"请输入邮箱","prefix-icon":"el-icon-message"},model:{value:e.resetPasswordForm.email,callback:function(r){e.$set(e.resetPasswordForm,"email",r)},expression:"resetPasswordForm.email"}})],1),s("el-form-item",{attrs:{prop:"token"}},[s("el-row",{attrs:{gutter:15}},[s("el-col",{attrs:{span:15}},[s("el-input",{attrs:{placeholder:"请输入验证码","prefix-icon":"el-icon-check"},model:{value:e.resetPasswordForm.token,callback:function(r){e.$set(e.resetPasswordForm,"token",r)},expression:"resetPasswordForm.token"}})],1),s("el-col",{attrs:{span:6}},[s("el-button",{attrs:{type:"primary",plain:""},on:{click:function(r){return e.sendToken()}}},[e._v(" 发送验证码 ")])],1)],1)],1),s("el-form-item",{attrs:{prop:"new_password"}},[s("el-input",{attrs:{type:"password",placeholder:"请输入新密码","prefix-icon":"el-icon-lock","show-password":""},model:{value:e.resetPasswordForm.new_password,callback:function(r){e.$set(e.resetPasswordForm,"new_password",r)},expression:"resetPasswordForm.new_password"}})],1)],1),s("div",[s("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.beforeSubmitResetPasswordForm()}}},[e._v("重置密码")]),s("el-button",{on:{click:function(r){return e.jumpToHome()}}},[e._v("取消")])],1),s("div",{staticClass:"margin_top_10"},[s("el-link",{attrs:{underline:!1,type:"primary"},on:{click:function(r){return e.switchForm("login")}}},[e._v("已有用户登陆")]),s("span",{staticStyle:{margin:"0px 10px",color:"#275ac0"}},[e._v("|")]),s("el-link",{attrs:{underline:!1,type:"primary"},on:{click:function(r){return e.switchForm("register")}}},[e._v("新用户注册")])],1)],1)])},o=[],i=s("7d8e"),n=s("9c40"),a={data:function(){var e=this,r=function(r,s,t){if(s===e.registerForm.password)return t();t(new Error("请确保两次输入密码一致"))};return{showWhichForm:"login",loginForm:{username_or_email:"",password:""},loginFormRules:{username_or_email:[{required:!0,message:"请输入用户名或邮箱",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},registerForm:{username:"",password:"",password_confirm:"",email:""},registerFormRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],password_confirm:[{required:!0,message:"请再次输入密码",trigger:"blur"},{validator:r,trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{validator:n["c"],trigger:"blur"}]},resetPasswordForm:{email:"",token:"",new_password:""},resetPasswordFormRules:{email:[{required:!0,message:"请输入邮箱",trigger:"blur"}],token:[{required:!0,message:"请输入验证码",trigger:"blur"}],new_password:[{required:!0,message:"请输入新密码",trigger:"blur"}]}}},methods:{switchForm:function(e){this.$refs.loginFormRef.resetFields(),this.$refs.registerFormRef.resetFields(),this.$refs.resetPasswordFormRef.resetFields(),this.showWhichForm=e},beforeSubmitLoginForm:function(){var e=this;this.$refs["loginFormRef"].validate((function(r){r&&e.submitLoginForm(e.loginForm)}))},submitLoginForm:function(e){var r={username_or_email:e.username_or_email,password:e.password},s=this;Object(i["g"])(r).then((function(e){s.$message({message:"登陆成功",type:"success"}),s.$router.push("/home")}))["catch"]((function(e){s.$message({message:"登陆失败",type:"warning"})}))},jumpToHome:function(){this.$router.push("/home")},beforeSubmitRegisterForm:function(){var e=this;this.$refs["registerFormRef"].validate((function(r){r&&e.submitRegisterForm(e.registerForm)}))},submitRegisterForm:function(e){var r={username:e.username,password:e.password,email:e.email,role:""},s=this;Object(i["i"])(r).then((function(){s.$message({message:"注册成功，自动登录中...",type:"success"});var r={username_or_email:e.username,password:e.password};s.submitLoginForm(r)}))["catch"]((function(e){s.$message({message:"注册失败",type:"warning"})}))},sendToken:function(){var e=this;Object(i["k"])(this.resetPasswordForm.email).then((function(){e.$message({message:"已发送验证码，请注意查收...",type:"success"})}))["catch"]((function(r){e.$message({message:"发送验证码失败【注意: 两小时之内只能发送一封验证邮件】",type:"warning"})}))},beforeSubmitResetPasswordForm:function(){var e=this;this.$refs["resetPasswordFormRef"].validate((function(r){r&&e.submitResetPasswordForm(e.resetPasswordForm)}))},submitResetPasswordForm:function(e){var r=this,s={by_old_password:!1,by_email:!0,by_email_body:{email:e.email,token:e.token,new_password:e.new_password}};Object(i["j"])(s).then((function(){r.$message({message:"重置密码成功",type:"success"})}))["catch"]((function(e){r.$message({message:"重置密码失败",type:"warning"})}))}}},c=a,u=(s("c74d"),s("2877")),m=Object(u["a"])(c,t,o,!1,null,"49d0822f",null);r["default"]=m.exports},"2b27":function(e,r,s){},"7d8e":function(e,r,s){"use strict";s.d(r,"i",(function(){return o})),s.d(r,"a",(function(){return i})),s.d(r,"g",(function(){return n})),s.d(r,"h",(function(){return a})),s.d(r,"c",(function(){return c})),s.d(r,"d",(function(){return u})),s.d(r,"k",(function(){return m})),s.d(r,"j",(function(){return l})),s.d(r,"f",(function(){return p})),s.d(r,"e",(function(){return d})),s.d(r,"b",(function(){return f})),s.d(r,"m",(function(){return g})),s.d(r,"n",(function(){return w})),s.d(r,"l",(function(){return b}));var t=s("d354");function o(e){return Object(t["c"])("/users",e)}function i(e){return Object(t["c"])("/users/batch_create",e)}function n(e){return Object(t["c"])("/users/login",e)}function a(){return Object(t["c"])("/users/logout")}function c(e){return Object(t["a"])("/users/".concat(e))}function u(e,r){return Object(t["d"])("/users/".concat(e),r)}function m(e){return Object(t["b"])("/users/reset_password/".concat(e))}function l(e){return Object(t["c"])("/users/reset_password",e)}function p(e){return Object(t["b"])("/users",e)}function d(e){return Object(t["b"])("/users/".concat(e))}function f(){return Object(t["b"])("/users/me")}function g(e){return Object(t["b"])("/submissions",e)}function w(e){return Object(t["b"])("/users/".concat(e,"/submissions_time"))}function b(e){return Object(t["b"])("/users/".concat(e,"/submissions_count"))}},c74d:function(e,r,s){"use strict";s("2b27")}}]);